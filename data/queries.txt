LOAD EMPLOYEE
LOAD WORKS_ON

<QUERY 1>
TEMP <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn,Salary FROM TEMP

<Q2 query>

TEMP1 <- PROJECT Ssn,Super_ssn,Bdate FROM EMPLOYEE
TEMP2 <- PROJECT Ssn,Super_ssn,Bdate FROM EMPLOYEE
T1 <- CROSS TEMP1 TEMP2
T2 <- SELECT TEMP1_Super_ssn == TEMP2_Ssn FROM T1
T3 <- SELECT TEMP1_Bdate == TEMP2_Bdate FROM T2
Q2 <- PROJECT TEMP1_Ssn, TEMP1_Super_ssn, TEMP1_Bdate FROM T3
RENAME TEMP1_Ssn TO Ssn FROM Q2
RENAME TEMP1_Super_ssn TO Super_ssn FROM Q2
RENAME TEMP1_Bdate TO Bdate FROM Q2

<QUERY 3>
T1 <- CROSS EMPLOYEE WORKS_ON
T2 <- SELECT Ssn == Essn FROM T1
T3 <- PROJECT Ssn,Pno,Sex FROM T2
T4 <- CROSS T3 T3
T5 <- SELECT T31_Pno == T32_Pno FROM T4
T6 <- SELECT T31_Sex != T32_Sex FROM T5
Q3 <- PROJECT T32_Pno FROM T6
RENAME T32_Pno TO Pno FROM Q3

<Q4 query>
W1 <- PROJECT Essn, Pno FROM WORKS_ON
W2 <- PROJECT Essn, Pno FROM WORKS_ON
FW <- CROSS W1 W2
FFW <- SELECT W1_Pno == W2_Pno FROM FW
TE <- PROJECT Ssn, Super_ssn FROM EMPLOYEE
IT <- CROSS TE FFW
SL <- SELECT Ssn == W1_Essn FROM IT
SL2 <- SELECT Super_ssn == W2_Essn FROM SL
Q4 <- PROJECT Ssn, Super_ssn, W1_Pno FROM SL2
RENAME W1_Pno TO Pno FROM Q4

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
QUIT
